<!DOCTYPE html>
<html>
  <head>
    <meta charset="UTF-8" />
    <title>Combined On-Campus Registration Form</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">
    <link rel="stylesheet" href="/utils/navbar.css">
    <style>
      .navbar {
        background-color: #2e7d32; /* dark green */
        color: white;
        display: flex;
        justify-content: space-between;
        align-items: center;
        padding: 1rem 2rem;
        position: relative;
      }
      .nav-links {
        list-style: none;
        display: flex;
        gap: 2rem;
      }

      .nav-links li a {
        text-decoration: none;
        color: white;
        font-weight: 500;
        font-size: 16px;
      }

      .nav-links li a:hover {
        color: #a5d6a7;
      }
      .footer {
        background-color: #033e2e;
        color: white;
        text-align: center;
        padding: 20px;
        font-size: 14px;
      }
      @page {
        size: 8.5in 13in;
        margin-left: 1cm;
        margin-right: 1cm;
        margin-top: 1cm;
        margin-bottom: 1cm;
      }
      @media print {
        .form-page {
          display: block !important;
        }
        .navbar,
        .footer
        .navigation {
          display: none !important;
        }
      }
      body {
        font-family: Century Gothic, sans-serif;
        font-size: 12px;
        margin: 0;
        padding: 0;
      }
      .form-container {
        width: 100%;
        padding: 10px;
        box-sizing: border-box;
      }
      table {
        width: 100%;
        border-collapse: collapse;
        margin-bottom: 10px;
      }
      td,
      th {
        border: 1px solid black;
        padding: 5px;
        vertical-align: top;
      }
      .no-border {
        border: none !important;
      }
      .form-title {
        background-color: #3535354d;
        text-align: center;
        font-weight: bold;
        padding: 8px;
        margin-bottom: 10px;
        border: 2px solid black;
        border-radius: 7px;
      }
      .two-columns {
        display: flex;
        gap: 10px;
        padding: 0;
        box-sizing: border-box;
      }
      .two-columns > div {
        flex: 1;
      }
      .two-columns table {
        width: 100%;
      }
      .page-break {
        page-break-before: always;
      }
      .section-title {
        font-weight: bold;
        background-color: #eee;
      }
      .small {
        font-size: 10px;
      }
      .header-row {
        display: flex;
        justify-content: space-between;
        align-items: center;
        margin-bottom: 4px;
      }
      .header-row img {
        height: 40px;
      }
      .form-page {
        display: none;
      }
      .form-page.active {
        display: block;
      }
      .navigation {
        display: flex;
        justify-content: space-between;
        align-items: center;
        margin-top: 20px;
      }
      button {
        padding: 6px 12px;
        font-size: 14px;
      }
    </style>
  </head>
  <script>
    function onlyOne(checkbox) {
      const checkboxes = document.getElementsByName("activity-type");
      checkboxes.forEach((cb) => {
        if (cb !== checkbox) cb.checked = false;
      });
    }
  </script>
  <body>
    <!-- Navbar Container -->
    <div id="navbar-container"></div>
    <form
      class="form-container"
      id="combinedForm"
      onsubmit="event.preventDefault(); submitSARFForm();"
    >
      <!-- PAGE 1 -->
      <!-- Header Section -->
      <div id="page1" class="form-page active">
        <div class="header-row">
          <img src="../images/UC_LOGO.png" alt="LOGO" />
          <div style="text-align: right">
            <strong>VICE PRESIDENT FOR ACADEMICS AND RESEARCH</strong><br />
            <span
              >___________________________________ <br />
              College
              &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp</span
            >
          </div>
        </div>

        <!-- Second Section -->
        <div class="form-title">
          STUDENT ACTIVITY REQUEST FORM FOR ON-CAMPUS
        </div>

        <table>
          <tr>
            <td rowspan="2" style="width: 50%">
              <strong class="small" style="font-size: 11px">
                This SARF is to be used by colleges, offices, recognized student
                organizations, student councils and faculty members for
                requesting approval of student activities in the campus. Submit
                SARF in Triplicate, two (2) weeks prior to start date of
                activity.
              </strong>
            </td>
            <td rowspan="2" style="width: 30%">
              <strong>Type of Activity</strong><br />
              <label
                ><input
                  type="checkbox"
                  name="activity-type"
                  value="Academic"
                  onclick="onlyOne(this)"
                />
                Academic</label
              ><br />
              <label
                ><input
                  type="checkbox"
                  name="activity-type"
                  value="Non-Academic"
                  onclick="onlyOne(this)"
                />
                Non-Academic</label
              ><br />
              <label
                ><input
                  type="checkbox"
                  name="activity-type"
                  value="College/Institutional"
                  onclick="onlyOne(this)"
                />
                College/Institutional</label
              >
            </td>
            <td style="width: 20%">
              <strong>SARF/Control No.:</strong><br />
              <input
                type="text"
                id="control"
                name="control"
                style="width: 99%"
              />
            </td>
          </tr>
          <tr>
            <td>
              Received:<br />
              <input
                type="date"
                id="received_date"
                name="received_date"
                style="width: 99%"
              />
            </td>
          </tr>
        </table>

        <!-- Third Section -->
        <div class="two-columns">
          <!-- Left Column -->
          <div>
            <table>
              <tr>
                <td>
                  <strong>Name of Organization/Office/College:</strong>
                  <input
                    type="text"
                    id="organization"
                    name="organization_name"
                    style="width: 99%"
                  />
                </td>
              </tr>
              <tr>
                <td>
                  <strong>Title of Activity/Program:</strong>
                  <input
                    type="text"
                    id="title"
                    name="title"
                    style="width: 99%"
                  />
                </td>
              </tr>
              <tr>
                <td>
                  <strong>Nature of Activity:</strong>
                  <input
                    type="text"
                    id="nature"
                    name="nature"
                    style="width: 99%"
                  />
                </td>
              </tr>
              <tr>
                <td><strong>Activity Date/Time:</strong></td>
              </tr>
              <tr>
                <td>
                  &nbsp;&nbsp;Start:
                  <input type="time" id="start-time" name="start-time" />
                </td>
              </tr>
              <tr>
                <td>
                  <strong>&nbsp;&nbsp;End:</strong>
                  <input type="time" id="end-time" name="end-time" />
                </td>
              </tr>
              <tr>
                <td>
                  <strong>Venue/Location:</strong>
                  <input
                    type="text"
                    id="location"
                    name="location"
                    style="width: 99%"
                  />
                </td>
              </tr>
            </table>

            <table>
              <tr>
                <td>
                  <strong>Participants:</strong><br />
                  <label
                    ><input
                      type="checkbox"
                      name="activity-type"
                      value="Academic"
                      onclick="onlyOne(this)"
                    />
                    Members/Office Staff Only</label
                  ><br />
                  <label
                    ><input
                      type="checkbox"
                      name="activity-type"
                      value="Academic"
                      onclick="onlyOne(this)"
                    />
                    With other UC Students/Employees</label
                  ><br />
                  <label
                    ><input
                      type="checkbox"
                      name="activity-type"
                      value="Academic"
                      onclick="onlyOne(this)"
                    />
                    Open to Public/Outsiders</label
                  ><br />
                  <strong>Estimated Total No. of Participants:</strong>
                  <input
                    type="number"
                    id="est_participants"
                    name="est_participants"
                    min="0"
                    step="1"
                  />
                </td>
              </tr>
            </table>
          </div>

          <!-- Right Column -->
          <div>
            <table>
              <tr>
                <td><strong>Remarks/Conditions:</strong></td>
              </tr>
              <tr>
                <td>
                  <textarea
                    name="remarks"
                    style="width: 98%; height: 110px; resize: vertical"
                  ></textarea>
                </td>
              </tr>
            </table>

            <table>
              <tr>
                <td>
                  <strong>Checklist (For Review Use Only)</strong><br />
                  <label
                    ><input type="checkbox" /> Copy of Letter of Invitation/MOA
                    (if with outside partner)</label
                  ><br />
                  <label
                    ><input type="checkbox" /> Speaker/Facilitator Resume</label
                  ><br />
                  <label><input type="checkbox" /> Organizing Committee</label
                  ><br />
                  <label><input type="checkbox" /> Budget Request Form</label
                  ><br />
                  <label
                    ><input type="checkbox" /> Copy of USC/CSC/Alternative
                    Resolutions</label
                  ><br />
                  <label
                    ><input type="checkbox" /> Copy of Program/Schedule of
                    Activities</label
                  ><br />
                  <label
                    ><input type="checkbox" /> Copy of Promotional
                    Material/Posters</label
                  ><br />
                  <label
                    ><input type="checkbox" /> Excuse Letter of Students</label
                  ><br />
                  <label><input type="checkbox" /> List of Participants</label
                  ><br />
                  <label
                    ><input type="checkbox" /> Venue Floor Plan/Physical
                    Set-up</label
                  ><br />
                  <label
                    ><input type="checkbox" /> Curfew Form (if
                    applicable)</label
                  >
                </td>
              </tr>
            </table>
          </div>
        </div>

        <div class="two-columns">
          <!-- Left Column -->
          <div>
            <table>
              <tr>
                <td colspan="2">
                  <strong>Source of Budget:</strong>
                  <input type="text" name="budget_source" style="width: 99%" />
                </td>
              </tr>
              <tr>
                <td colspan="2">
                  <strong>Estimated Total Budget:</strong>
                  <input
                    type="text"
                    name="estimated_budget"
                    style="width: 99%"
                  />
                </td>
              </tr>
              <tr>
                <td
                  colspan="2"
                  class="section-title"
                  style="text-align: center"
                >
                  <strong>In-Charge of Activity</strong>
                </td>
              </tr>
              <tr>
                <td style="width: 30%"><strong>Name:</strong></td>
                <td>
                  <input type="text" name="incharge_name" style="width: 99%" />
                </td>
              </tr>
              <tr>
                <td><strong>Designation:</strong></td>
                <td>
                  <input
                    type="text"
                    name="incharge_designation"
                    style="width: 99%"
                  />
                </td>
              </tr>
              <tr>
                <td><strong>Contact No.:</strong></td>
                <td>
                  <input
                    type="text"
                    name="incharge_contact"
                    style="width: 99%"
                  />
                </td>
              </tr>
              <tr>
                <td><strong>Email Address:</strong></td>
                <td>
                  <input
                    type="email"
                    name="incharge_email"
                    style="width: 99%"
                  />
                </td>
              </tr>

              <tr>
                <td colspan="2" style="height: 100px">
                  <div style="text-align: center">
                    <strong style="font-size: 14px">
                      Liability Waiver<br />
                      [To be accomplished by the Adviser/Coordinator]
                    </strong>
                  </div>
                  <p style="font-size: 13px; text-align: justify">
                    I certify that the undersigned will stay with the students
                    and participants for the duration of the aforementioned
                    activity. Further, I acknowledge that as an Adviser of the
                    organizing body, I am fully liable to any untoward events
                    that may arise during the conduct of the above activity. My
                    signature below indicates that I have read the policy stated
                    in this Liability Waiver Form, and that I agree to abide by
                    this policy.
                  </p>
                  <br /><br />
                  <div style="height: 110px">
                    <strong>
                      <div
                        style="display: flex; justify-content: space-between"
                      >
                        <div style="text-align: center; width: 60%">
                          _____________________________<br />
                          Adviser/Coordinator
                        </div>
                        <div style="text-align: center; width: 35%">
                          ___________________<br />
                          Date
                        </div>
                      </div>
                    </strong>
                  </div>
                </td>
              </tr>
            </table>
          </div>

          <!-- Right Column -->
          <div>
            <table>
              <tr>
                <td
                  colspan="2"
                  class="section-title"
                  style="text-align: center"
                >
                  <strong>SIGNATURES: Printed Name and Signature, Date</strong>
                </td>
              </tr>
              <tr>
                <td>
                  <strong>&nbsp;&nbsp;Submitted By:</strong> <br />
                  <br />
                  <p>
                    &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;___________________________________&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Date:
                    ________________
                    <br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;President/Organizer
                  </p>
                  <br />
                  <strong>&nbsp;&nbsp;Noted By:</strong> <br />
                  <br />
                  <p>
                    &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;___________________________________&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Date:
                    ________________
                    <br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Adviser/Corrdinator
                  </p>
                  <br />
                  <strong>&nbsp;&nbsp;Recommending Approval:</strong> <br />
                  <br />
                  <p>
                    &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;___________________________________&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Date:
                    ________________
                    <br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Academic
                    Dean/Prog. Chair
                  </p>
                  <br />
                  <strong>&nbsp;&nbsp;Approved By:</strong> <br />
                  <br />
                  <p>
                    &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;___________________________________&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Date:
                    ________________
                    <br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;VP
                    for Academics and Research
                  </p>
                  <br />
                  <strong>&nbsp;&nbsp;Venue Reserved:</strong> <br />
                  <br />
                  <p>
                    &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;___________________________________&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Date:
                    ________________ <br />&nbsp;&nbsp;&nbsp;Campus Facilities,
                    Planning $ Dev't Officer
                  </p>
                  <br />
                </td>
              </tr>
            </table>
          </div>
        </div>

        <table>
          <td colspan="7" class="section-title" style="text-align: center">
            <strong>Amount of insurance per insured individual (PhP)</strong>
          </td>
          <tr>
            <th style="width: 12%">Description of Persons to be Covered</th>
            <th>Basic Life</th>
            <th>Accidental Death & Dismemberment</th>
            <th>Double Indemnity for Public Conveyance</th>
            <th>Accidental Medical Expense</th>
            <th>Daily Accident Hospital Benefit</th>
            <th>Unprovoked Murder & Assault</th>
          </tr>
          <tr>
            <th>All Eligible Students</th>
            <th>15,000</th>
            <th>150,000</th>
            <th>300,000</th>
            <th>50,000</th>
            <th>500</th>
            <th>150,000</th>
          </tr>
        </table>

        <!-- Pg 1 nav -->
        <div class="navigation">
          <span>Page 1 of 2</span>
          <button type="button" onclick="goToPage(2)">Next Page →</button>
        </div>
      </div>

      <!-- PAGE 2 -->
      <div id="page2" class="form-page">
        <div class="two-columns">
          <!-- Left Column -->
          <div>
            <table>
              <td colspan="2" class="section-title" style="text-align: center">
                <strong>For BMO Support (if applicable)</strong><br />
                <strong
                  >Venue: <input type="text" name="venue" style="width: 87%"
                /></strong>
              </td>
              <tr>
                <td style="width: 50%">
                  <p>Technical Requirements:</p>
                  <label
                    ><input type="checkbox" /><input
                      type="number"
                      id="wl_mic"
                      name="wl_mic"
                      min="0"
                      step="1"
                      style="width: 20%"
                    />
                    pcs of WL microphones</label
                  ><br />
                  <label
                    ><input type="checkbox" /><input
                      type="number"
                      id="wired_mic"
                      name="wired_mic"
                      min="0"
                      step="1"
                      style="width: 20%"
                    />
                    pcs of wired microphones</label
                  ><br />
                  <label
                    ><input type="checkbox" /><input
                      type="number"
                      id="mic_stands"
                      name="mic_stands"
                      min="0"
                      step="1"
                      style="width: 20%"
                    />
                    pcs of microphone stands</label
                  ><br />
                  <label><input type="checkbox" /> Laptop</label><br />
                  <label><input type="checkbox" /> Projector</label><br />
                  <label><input type="checkbox" /> PA System</label><br />
                  <label><input type="checkbox" /> VA mixer</label><br />
                  <label
                    ><input type="checkbox" /><input
                      type="number"
                      id="lights"
                      name="lights"
                      min="0"
                      step="1"
                      style="width: 20%"
                    />
                    par lights</label
                  ><br />
                  <label
                    ><input type="checkbox" /> Moving intelligent lights</label
                  ><br />
                  <label><input type="checkbox" /> Follow Spot</label><br />
                  <label><input type="checkbox" /> Others</label
                  ><input
                    type="text"
                    name="others_tech"
                    style="width: 97%"
                  /><br />
                </td>
                <td>
                  <strong>Other Requirements:</strong><br />
                  <textarea
                    name="remarks"
                    style="width: 98%; height: 110px; resize: vertical"
                  ></textarea
                  ><br /><br />
                  <strong>Remarks:</strong><br />
                  <textarea
                    name="remarks"
                    style="width: 98%; height: 110px; resize: vertical"
                  ></textarea
                  ><br />
                </td>
              </tr>
              <tr>
                <td colspan="2" style="text-align: center">
                  <div
                    style="
                      display: flex;
                      justify-content: space-between;
                      margin-bottom: 5px;
                    "
                  >
                    <div style="text-align: left; width: 48%">
                      <strong>Noted and Prroved:</strong>
                    </div>
                    <div style="text-align: center; width: 52%">
                      <strong>Date:</strong>
                    </div>
                  </div>

                  <div style="display: flex; justify-content: space-between">
                    <div style="text-align: center; width: 60%">
                      <strong>_____________________________</strong><br />
                      <strong>Head, LMO</strong>
                    </div>
                    <div style="text-align: center; width: 35%">
                      <strong>_______________________</strong>
                    </div>
                  </div>
                </td>
              </tr>
            </table>
          </div>

          <!-- Right Column -->
          <div>
            <table>
              <td
                colspan="2"
                class="section-title"
                style="text-align: center; height: 35px"
              >
                <strong>For LMO Support (if applicable)</strong><br />
              </td>
              <tr>
                <td style="width: 50%">
                  <p>Property Requirements:</p>
                  <label><input type="checkbox" /> Podium</label><br />
                  <label><input type="checkbox" /> Philippine Flag</label><br />
                  <label><input type="checkbox" /> UC Flag</label><br />
                  <label><input type="checkbox" /> Flagpoles</label><br />
                  <label
                    ><input type="checkbox" /><input
                      type="number"
                      id="long_table"
                      name="long_table"
                      min="0"
                      step="1"
                      style="width: 20%"
                    />
                    pcs of long tables</label
                  ><br />
                  <label
                    ><input type="checkbox" /><input
                      type="number"
                      id="teachers_tables"
                      name="teachers_tables"
                      min="0"
                      step="1"
                      style="width: 20%"
                    />
                    pcs of teachers tables</label
                  ><br />
                  <label
                    ><input type="checkbox" /><input
                      type="number"
                      id="platforms"
                      name="platforms"
                      min="0"
                      step="1"
                      style="width: 20%"
                    />
                    pcs of platforms</label
                  ><br />
                  <label
                    ><input type="checkbox" /><input
                      type="number"
                      id="chairs"
                      name="chairs"
                      min="0"
                      step="1"
                      style="width: 20%"
                    />
                    pcs of chairs</label
                  ><br />
                  <label
                    ><input type="checkbox" /><input
                      type="number"
                      id="participants"
                      name="trashbins"
                      min="0"
                      step="1"
                      style="width: 20%"
                    />
                    pcs of trashbins</label
                  ><br />
                  <label><input type="checkbox" /> Others</label
                  ><input
                    type="text"
                    name="others_req"
                    style="width: 87%"
                  /><br />
                </td>
                <td>
                  <strong>Other Requirements:</strong><br />
                  <textarea
                    name="remarks"
                    style="width: 98%; height: 110px; resize: vertical"
                  ></textarea
                  ><br /><br />
                  <strong>Remarks:</strong><br />
                  <textarea
                    name="remarks"
                    style="width: 98%; height: 110px; resize: vertical"
                  ></textarea
                  ><br />
                </td>
              </tr>
              <tr>
                <td colspan="2" style="text-align: center">
                  <div
                    style="
                      display: flex;
                      justify-content: space-between;
                      margin-bottom: 5px;
                    "
                  >
                    <div style="text-align: left; width: 48%">
                      <strong>Noted and Prroved:</strong>
                    </div>
                    <div style="text-align: center; width: 52%">
                      <strong>Date:</strong>
                    </div>
                  </div>

                  <div style="display: flex; justify-content: space-between">
                    <div style="text-align: center; width: 60%">
                      <strong>_____________________________</strong><br />
                      <strong>Head, LMO</strong>
                    </div>
                    <div style="text-align: center; width: 35%">
                      <strong>_______________________</strong>
                    </div>
                  </div>
                </td>
              </tr>
            </table>
          </div>
        </div>

        <!-- Second Column -->
        <div class="two-columns">
          <!-- Left Column -->
          <div>
            <table>
              <td colspan="2" class="section-title" style="text-align: center">
                <strong>For ITSS Support (if applicable)</strong><br />
              </td>
              <tr>
                <td style="width: 50%">
                  <p>Support Requirements:</p>
                  <label><input type="checkbox" /> Internet Connection</label
                  ><br />
                  <label><input type="checkbox" /> Deskstop stations</label
                  ><br />
                  <label
                    ><input type="checkbox" /> Internet network support</label
                  ><br />
                  <label><input type="checkbox" /> Web/FB posting</label><br />
                  <p>
                    (attach material here or email it to *aopardo@uc-bcf.edu.ph
                    all subject to approval and editing)
                  </p>
                  <label
                    ><input type="checkbox" /> Additional multimedia
                    equipment</label
                  ><input
                    type="text"
                    name="multimedia"
                    style="width: 97%; height: 40px"
                  /><br />
                  <label><input type="checkbox" /> Others</label
                  ><input
                    type="text"
                    name="others_support"
                    style="width: 97%"
                  /><br /><br />
                </td>
                <td>
                  <strong>Other Requirements:</strong><br />
                  <textarea
                    name="remarks"
                    style="width: 98%; height: 110px; resize: vertical"
                  ></textarea
                  ><br /><br />
                  <strong>Remarks:</strong><br />
                  <textarea
                    name="remarks"
                    style="width: 98%; height: 110px; resize: vertical"
                  ></textarea
                  ><br />
                </td>
              </tr>
              <tr>
                <td colspan="2" style="text-align: center">
                  <div
                    style="
                      display: flex;
                      justify-content: space-between;
                      margin-bottom: 5px;
                    "
                  >
                    <div style="text-align: left; width: 48%">
                      <strong>Noted and Approved:</strong>
                    </div>
                    <div style="text-align: center; width: 52%">
                      <strong>Date:</strong>
                    </div>
                  </div>

                  <div style="display: flex; justify-content: space-between">
                    <div style="text-align: center; width: 60%">
                      <strong>_____________________________</strong><br />
                      <strong>Director</strong>
                    </div>
                    <div style="text-align: center; width: 35%">
                      <strong>_______________________</strong>
                    </div>
                  </div>
                </td>
              </tr>
            </table>
          </div>

          <!-- Right Column -->
          <div>
            <table>
              <td colspan="2" class="section-title" style="text-align: center">
                <strong>For ADMINISTRATIVE Support (if applicable)</strong
                ><br />
              </td>
              <tr>
                <td style="width: 50%">
                  <p>Property Requirements:</p>
                  <label><input type="checkbox" /> Medical/first-aid</label
                  ><br />
                  <label
                    ><input type="checkbox" /><input
                      type="number"
                      id="guards"
                      name="guards"
                      min="0"
                      step="1"
                      style="width: 20%"
                    />
                    security guards</label
                  ><br />
                  <label
                    ><input type="checkbox" />Parking for
                    <input
                      type="number"
                      id="parking"
                      name="parking"
                      min="0"
                      step="1"
                      style="width: 20%"
                    />
                    vehicles</label
                  ><br />
                  <label
                    ><input type="checkbox" /> Other personnel/staff<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<input
                      type="text"
                      name="personnel/staff"
                      style="width: 87%" /></label
                  ><br />
                  <label
                    ><input type="checkbox" /> Transportation:
                    <input
                      type="text"
                      name="transportation"
                      style="width: 49%" /></label
                  ><br />
                  <label><input type="checkbox" /> Green board posting:</label
                  ><br />
                  <p>(write text below, all subject to approval and editing)</p>
                  <input
                    type="text"
                    name="posting"
                    style="width: 97%; height: 60px"
                  />
                </td>
                <td>
                  <strong>Other Requirements:</strong><br />
                  <textarea
                    name="remarks"
                    style="width: 98%; height: 110px; resize: vertical"
                  ></textarea
                  ><br /><br />
                  <strong>Remarks:</strong><br />
                  <textarea
                    name="remarks"
                    style="width: 98%; height: 110px; resize: vertical"
                  ></textarea
                  ><br />
                </td>
              </tr>
              <tr>
                <td colspan="2" style="text-align: center">
                  <div
                    style="
                      display: flex;
                      justify-content: space-between;
                      margin-bottom: 5px;
                    "
                  >
                    <div style="text-align: left; width: 48%">
                      <strong>Noted and Prroved:</strong>
                    </div>
                    <div style="text-align: center; width: 52%">
                      <strong>Date:</strong>
                    </div>
                  </div>

                  <div style="display: flex; justify-content: space-between">
                    <div style="text-align: center; width: 60%">
                      <strong>_____________________________</strong><br />
                      <strong>VP for Admin and Acad Services</strong>
                    </div>
                    <div style="text-align: center; width: 35%">
                      <strong>_______________________</strong>
                    </div>
                  </div>
                </td>
              </tr>
            </table>
          </div>
        </div>

        <!-- Third Column -->
        <div>
          <!-- Left Column -->
          <div>
            <table>
              <td colspan="3" class="section-title" style="text-align: center">
                <strong>For FMO Use:</strong><br />
              </td>
              <tr>
                <td style="width: 35%">
                  <p>Applicable Charges: (if any)</p>
                  <label
                    ><input type="checkbox" /> Janitorial
                    &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PhP&nbsp;&nbsp;<input
                      type="number"
                      id="janitoring"
                      name="janitoring"
                      min="0"
                      step="1"
                      style="width: 50%" /></label
                  ><br />
                  <label
                    ><input type="checkbox" /> Houselights
                    &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PhP&nbsp;&nbsp;<input
                      type="number"
                      id="houselights"
                      name="houselights"
                      min="0"
                      step="1"
                      style="width: 50%" /></label
                  ><br />
                  <label
                    ><input type="checkbox" /> Technical
                    &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PhP&nbsp;&nbsp;<input
                      type="number"
                      id="technical"
                      name="technical"
                      min="0"
                      step="1"
                      style="width: 50%" /></label
                  ><br />
                  <label
                    ><input type="checkbox" /> Water
                    &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PhP&nbsp;&nbsp;<input
                      type="number"
                      id="water"
                      name="water"
                      min="0"
                      step="1"
                      style="width: 50%" /></label
                  ><br />
                  <label
                    ><input type="checkbox" /> Staff OT
                    &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PhP&nbsp;&nbsp;<input
                      type="number"
                      id="staff_ot"
                      name="staff_ot"
                      min="0"
                      step="1"
                      style="width: 50%" /></label
                  ><br />
                  <label
                    ><input type="checkbox" /> Others
                    &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PhP&nbsp;&nbsp;<input
                      type="number"
                      id="others_applicable"
                      name="others_applicable"
                      min="0"
                      step="1"
                      style="width: 50%"
                    /> </label
                  ><br /><br /><br />
                  <strong
                    >&nbsp;&nbsp;Total:
                    &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PhP&nbsp;&nbsp;<input
                      type="number"
                      id="total"
                      name="total"
                      min="0"
                      step="1"
                      style="width: 50%"
                    /> </strong
                  ><br /><br />
                </td>
                <td style="width: 24%">
                  <strong>Other Requirements:</strong><br />
                  <textarea
                    name="remarks"
                    style="width: 98%; height: 110px; resize: vertical"
                  ></textarea
                  ><br /><br />
                  <strong>Remarks:</strong><br />
                  <textarea
                    name="remarks"
                    style="width: 98%; height: 110px; resize: vertical"
                  ></textarea
                  ><br />
                </td>
                <td style="width: 41%">
                  <div style="text-align: center">
                    <strong style="font-size: 14px"> Service Agreement </strong>
                  </div>
                  <p style="font-size: 14px">
                    &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;I have read and discussed with
                    the Director of FMO the policies and guidelines on the use
                    of UC facilies and accept personal responsibility to abide
                    by them. I understand that the use of UC facilities is
                    contigent upon the approval of the concerned officials. I
                    also understand that there may be additional charges as
                    enumerated here. <br />
                    &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;By signing here, I acknowledge
                    responsibility for the care and condition of facilities and
                    equipment used during the activity.
                  </p>
                  <br /><br /><br />
                  <p style="text-align: center; margin-top: 20px">
                    <span
                      style="
                        display: inline-block;
                        text-align: center;
                        margin-right: 40px;
                      "
                    >
                      <strong>________________________________</strong><br />
                      In-charge of Activity<br />
                      (Printed Name and Signature)
                    </span>
                    <span style="display: inline-block; text-align: center">
                      <strong>________________</strong><br />
                      Date
                    </span>
                  </p>
                </td>
              </tr>
              <tr>
                <td colspan="3" style="text-align: center">
                  <strong>Approved and Reserved:</strong><br />

                  <div
                    style="
                      display: inline-block;
                      text-align: center;
                      margin-right: 40px;
                    "
                  >
                    <strong
                      >_____________________________________________</strong
                    ><br />
                    <strong>Campus Facilities, Planning & Dev't Officer</strong>
                  </div>
                  <div style="display: inline-block; text-align: center">
                    <strong>_________________________</strong><br />
                    <strong>Date</strong>
                  </div>
                </td>
              </tr>
            </table>
          </div>

          <!-- Pg nav -->
          <div class="navigation">
            <button type="button" onclick="goToPage(1)">← Previous Page</button>
            <span>Page 2 of 2</span>
            <button type="submit" id="submitBtn">
              <i class="fas fa-eye"></i> Preview PDF
            </button>
          </div>
        </div>
      </div>
    </form>

    <!-- Preview Modal -->
    <div id="previewModal" class="modal" style="display: none;">
      <div class="modal-content preview-modal">
        <div class="modal-header">
          <h2><i class="fas fa-file-pdf"></i> Preview Your SARF Form</h2>
          <button class="close-btn" onclick="closePreviewModal()">
            <i class="fas fa-times"></i>
          </button>
        </div>
        <div class="modal-body">
          <div class="preview-info">
            <div class="control-info">
              <span class="control-label">Control Number:</span>
              <span class="control-number" id="modalControlNo"></span>
            </div>
            <p class="preview-instruction">
              <i class="fas fa-info-circle"></i>
              Please review your form details below. If everything looks correct, click "Submit" to finalize your submission.
            </p>
          </div>

          <div class="pdf-viewer-container">
            <div class="pdf-toolbar">
              <button onclick="downloadPreviewPDF()" class="toolbar-btn download-btn">
                <i class="fas fa-download"></i> Download PDF
              </button>
              <button onclick="openPDFNewTab()" class="toolbar-btn">
                <i class="fas fa-external-link-alt"></i> Open in New Tab
              </button>
            </div>
            <div class="pdf-container">
              <iframe id="pdfPreview" class="pdf-iframe" loading="lazy"></iframe>
            </div>
          </div>

          <div class="modal-actions">
            <button onclick="finalSubmit()" class="btn btn-submit">
              <i class="fas fa-check"></i>
              <span>Submit</span>
            </button>
            <button onclick="closePreviewModal()" class="btn btn-cancel">
              <i class="fas fa-times"></i>
              <span>Cancel</span>
            </button>
          </div>
        </div>
      </div>
    </div>

    <!-- Success Modal -->
    <div id="successModal" class="modal" style="display: none;">
      <div class="modal-content">
        <div class="modal-header">
          <h2>✅ SARF Form Submitted Successfully!</h2>
        </div>
        <div class="modal-body">
          <p><strong>Control Number:</strong> <span id="successControlNo"></span></p>
          <p><strong>Status:</strong> Pending Review</p>
          <p>Your Student Activity Request Form has been submitted to the database and is now pending review.</p>
          <div class="modal-actions">
            <button onclick="viewMyForms()" class="btn-primary">View My Forms</button>
            <button onclick="closeSuccessModal()" class="btn-secondary">Close</button>
          </div>
        </div>
      </div>
    </div>

    <!-- Loading Modal -->
    <div id="loadingModal" class="modal" style="display: none;">
      <div class="modal-content">
        <div class="modal-body" style="text-align: center;">
          <div class="loading-spinner"></div>
          <p>Submitting your SARF form and generating PDF...</p>
          <p>Please wait, this may take a few moments.</p>
        </div>
      </div>
    </div>

    <style>
      .modal {
        position: fixed;
        z-index: 1000;
        left: 0;
        top: 0;
        width: 100%;
        height: 100%;
        background-color: rgba(0,0,0,0.7);
        display: flex;
        justify-content: center;
        align-items: center;
        backdrop-filter: blur(2px);
      }

      .modal-content {
        background-color: white;
        border-radius: 12px;
        max-width: 500px;
        width: 90%;
        box-shadow: 0 10px 30px rgba(0,0,0,0.3);
        overflow: hidden;
      }

      .preview-modal {
        max-width: 95vw;
        width: 95vw;
        height: 90vh;
        max-height: 90vh;
      }

      .modal-header {
        background: linear-gradient(135deg, #2e7d32, #4caf50);
        color: white;
        padding: 20px;
        display: flex;
        justify-content: space-between;
        align-items: center;
      }

      .modal-header h2 {
        margin: 0;
        font-size: 24px;
        font-weight: 600;
      }

      .close-btn {
        background: rgba(255,255,255,0.2);
        border: none;
        color: white;
        width: 40px;
        height: 40px;
        border-radius: 50%;
        cursor: pointer;
        display: flex;
        align-items: center;
        justify-content: center;
        transition: background-color 0.3s;
      }

      .close-btn:hover {
        background: rgba(255,255,255,0.3);
      }

      .modal-body {
        padding: 0;
        height: calc(90vh - 140px);
        display: flex;
        flex-direction: column;
      }

      .preview-info {
        padding: 20px;
        background: #f8f9fa;
        border-bottom: 1px solid #e9ecef;
      }

      .control-info {
        display: flex;
        align-items: center;
        gap: 10px;
        margin-bottom: 10px;
      }

      .control-label {
        font-weight: 600;
        color: #495057;
      }

      .control-number {
        background: #e8f5e8;
        color: #2e7d32;
        padding: 4px 12px;
        border-radius: 20px;
        font-weight: 600;
        font-size: 14px;
      }

      .preview-instruction {
        margin: 0;
        color: #6c757d;
        font-size: 14px;
        display: flex;
        align-items: center;
        gap: 8px;
      }

      .pdf-viewer-container {
        flex: 1;
        display: flex;
        flex-direction: column;
        overflow: hidden;
      }

      .pdf-toolbar {
        background: #f8f9fa;
        padding: 10px 20px;
        border-bottom: 1px solid #e9ecef;
        display: flex;
        align-items: center;
        gap: 15px;
      }

      .toolbar-btn {
        background: white;
        border: 1px solid #dee2e6;
        padding: 8px 12px;
        border-radius: 6px;
        cursor: pointer;
        font-size: 14px;
        display: flex;
        align-items: center;
        gap: 5px;
        transition: all 0.3s;
      }

      .toolbar-btn:hover {
        background: #e9ecef;
        border-color: #adb5bd;
      }

      .download-btn {
        background: #007bff;
        color: white;
        border-color: #007bff;
      }

      .download-btn:hover {
        background: #0056b3;
        border-color: #0056b3;
      }

      .zoom-level {
        font-weight: 600;
        color: #495057;
        min-width: 50px;
        text-align: center;
      }

      .pdf-container {
        flex: 1;
        padding: 20px;
        overflow: auto;
        background: #f8f9fa;
      }

      .pdf-iframe {
        width: 100%;
        height: 100%;
        border: none;
        border-radius: 8px;
        box-shadow: 0 4px 12px rgba(0,0,0,0.15);
        background: white;
        min-height: 600px;
      }

      .modal-actions {
        padding: 20px;
        background: white;
        border-top: 1px solid #e9ecef;
        display: flex;
        gap: 15px;
        justify-content: center;
      }

      .btn {
        padding: 12px 30px;
        border: none;
        border-radius: 8px;
        cursor: pointer;
        font-size: 16px;
        font-weight: 600;
        display: flex;
        align-items: center;
        gap: 8px;
        transition: all 0.3s;
        min-width: 140px;
        justify-content: center;
      }

      .btn-submit {
        background: linear-gradient(135deg, #28a745, #20c997);
        color: white;
        box-shadow: 0 4px 12px rgba(40, 167, 69, 0.3);
      }

      .btn-submit:hover {
        background: linear-gradient(135deg, #218838, #1ea085);
        transform: translateY(-2px);
        box-shadow: 0 6px 16px rgba(40, 167, 69, 0.4);
      }

      .btn-cancel {
        background: #6c757d;
        color: white;
      }

      .btn-cancel:hover {
        background: #5a6268;
        transform: translateY(-2px);
      }

      .loading-spinner {
        border: 4px solid #f3f3f3;
        border-top: 4px solid #2e7d32;
        border-radius: 50%;
        width: 40px;
        height: 40px;
        animation: spin 1s linear infinite;
        margin: 0 auto 20px auto;
      }

      @keyframes spin {
        0% { transform: rotate(0deg); }
        100% { transform: rotate(360deg); }
      }

      /* Regular modal styles for success modal */
      .modal-content:not(.preview-modal) {
        padding: 20px;
        max-width: 500px;
      }

      .modal-content:not(.preview-modal) .modal-header h2 {
        background: none;
        color: #2e7d32;
        margin: 0 0 15px 0;
      }

      .modal-content:not(.preview-modal) .modal-body p {
        margin: 10px 0;
      }

      .modal-content:not(.preview-modal) .modal-actions {
        margin-top: 20px;
        padding: 0;
        border: none;
        background: none;
      }

      .btn-primary, .btn-secondary {
        padding: 10px 20px;
        border: none;
        border-radius: 4px;
        cursor: pointer;
        font-size: 14px;
      }

      .btn-primary {
        background-color: #2e7d32;
        color: white;
      }

      .btn-secondary {
        background-color: #ccc;
        color: #333;
      }

      /* Form submit button styling */
      #submitBtn {
        background: linear-gradient(135deg, #007bff, #0056b3);
        color: white;
        border: none;
        padding: 12px 24px;
        border-radius: 8px;
        font-size: 16px;
        font-weight: 600;
        cursor: pointer;
        display: flex;
        align-items: center;
        gap: 8px;
        transition: all 0.3s;
        box-shadow: 0 4px 12px rgba(0, 123, 255, 0.3);
      }

      #submitBtn:hover {
        background: linear-gradient(135deg, #0056b3, #004085);
        transform: translateY(-2px);
        box-shadow: 0 6px 16px rgba(0, 123, 255, 0.4);
      }

      #submitBtn:active {
        transform: translateY(0);
      }
    </style>

    <script>
      function goToPage(pageNumber) {
        document
          .querySelectorAll(".form-page")
          .forEach((p) => p.classList.remove("active"));
        document.getElementById("page" + pageNumber).classList.add("active");
      }
      window.goToPage = goToPage;

      let currentFormData = null;
      let previewPdfUrl = null;

      // Submit SARF Form (Preview Step)
      async function submitSARFForm() {
        try {
          // Show loading modal
          document.getElementById('loadingModal').style.display = 'flex';

          // Collect form data
          const formData = collectFormData();

          // Validate required fields
          if (!validateForm(formData)) {
            document.getElementById('loadingModal').style.display = 'none';
            return;
          }

          // Store form data for final submission
          currentFormData = formData;

          // Generate preview PDF
          const token = localStorage.getItem('token');
          const response = await fetch('/api/sarf/preview-pdf', {
            method: 'POST',
            headers: {
              'Content-Type': 'application/json',
              'Authorization': `Bearer ${token}`
            },
            body: JSON.stringify(formData)
          });

          const result = await response.json();

          // Hide loading modal
          document.getElementById('loadingModal').style.display = 'none';

          if (result.success) {
            // Store PDF URL for preview
            previewPdfUrl = result.pdfUrl;

            // Show preview modal
            document.getElementById('modalControlNo').textContent = result.control || 'Auto-generated';
            document.getElementById('pdfPreview').src = result.pdfUrl;
            document.getElementById('previewModal').style.display = 'flex';
          } else {
            alert('Error generating preview: ' + result.message);
          }

        } catch (error) {
          document.getElementById('loadingModal').style.display = 'none';
          console.error('Error generating preview:', error);
          alert('Failed to generate preview. Please try again.');
        }
      }

      // Final submission to database
      async function finalSubmit() {
        try {
          if (!currentFormData) {
            alert('No form data available. Please try again.');
            return;
          }

          // Show loading
          document.getElementById('previewModal').style.display = 'none';
          document.getElementById('loadingModal').style.display = 'flex';

          // Submit to database
          const token = localStorage.getItem('token');
          const response = await fetch('/api/sarf/submit', {
            method: 'POST',
            headers: {
              'Content-Type': 'application/json',
              'Authorization': `Bearer ${token}`
            },
            body: JSON.stringify(currentFormData)
          });

          const result = await response.json();

          // Hide loading modal
          document.getElementById('loadingModal').style.display = 'none';

          if (result.success) {
            // Show success modal
            document.getElementById('successControlNo').textContent = result.data.control;
            document.getElementById('successModal').style.display = 'flex';

            // Reset form and data
            document.getElementById('combinedForm').reset();
            currentFormData = null;
            previewPdfUrl = null;
            goToPage(1);
          } else {
            console.error('Submission failed:', result);
            let errorMessage = result.message || 'Unknown error occurred';

            // Show detailed validation errors if available
            if (result.errors && result.errors.length > 0) {
              errorMessage += '\n\nValidation Errors:\n' + result.errors.join('\n');
            }

            if (result.warnings && result.warnings.length > 0) {
              errorMessage += '\n\nWarnings:\n' + result.warnings.join('\n');
            }

            alert('Error submitting to database:\n' + errorMessage);
            // Show preview modal again
            document.getElementById('previewModal').style.display = 'flex';
          }

        } catch (error) {
          document.getElementById('loadingModal').style.display = 'none';
          console.error('Error submitting to database:', error);
          alert('Failed to submit to database. Please try again.');
          // Show preview modal again
          document.getElementById('previewModal').style.display = 'flex';
        }
      }

      // Collect form data - COMPLETE collection including empty fields
      function collectFormData() {
        const form = document.getElementById('combinedForm');

        // Initialize data object with ALL possible fields set to default values
        const data = {
          // Page 1 - Basic Information
          control: '',
          received_date: '',
          activity_type: '',
          organization_name: '',
          title: '',
          nature: '',
          start_time: '',
          end_time: '',
          location: '',
          est_participants: '',
          budget_source: '',
          estimated_budget: '',
          incharge_name: '',
          incharge_designation: '',
          incharge_contact: '',
          incharge_email: '',
          remarks: '',

          // Page 2 - Technical Requirements (BMO Support)
          venue: '',
          wl_mic: '0',
          wired_mic: '0',
          mic_stands: '0',
          lights: '0',
          others_tech: '',

          // Property Requirements (LMO Support)
          long_table: '0',
          teachers_tables: '0',
          platforms: '0',
          chairs: '0',
          trashbins: '0',
          others_req: '',

          // ITSS Support
          multimedia: '',
          others_support: '',

          // Administrative Support
          guards: '0',
          parking: '0',
          transportation: '',
          posting: '',

          // FMO Charges
          janitoring: '0',
          houselights: '0',
          technical: '0',
          water: '0',
          staff_ot: '0',
          others_applicable: '0',
          total: '0'
        };

        // Now collect actual values, preserving empty fields as empty strings or '0'
        // Basic form fields
        const controlField = document.getElementById('control');
        if (controlField) data.control = controlField.value || '';

        const receivedDateField = document.getElementById('received_date');
        if (receivedDateField) data.received_date = receivedDateField.value || '';

        const orgNameField = document.querySelector('input[name="organization_name"]');
        if (orgNameField) data.organization_name = orgNameField.value || '';

        const titleField = document.querySelector('input[name="title"]');
        if (titleField) data.title = titleField.value || '';

        const natureField = document.querySelector('input[name="nature"]');
        if (natureField) data.nature = natureField.value || '';

        const locationField = document.querySelector('input[name="location"]');
        if (locationField) data.location = locationField.value || '';

        // Time fields
        const startTimeField = document.getElementById('start-time');
        if (startTimeField) data.start_time = startTimeField.value || '';

        const endTimeField = document.getElementById('end-time');
        if (endTimeField) data.end_time = endTimeField.value || '';

        // Participants
        const participantsField = document.getElementById('est_participants');
        if (participantsField) data.est_participants = participantsField.value || '';

        // Budget
        const budgetSourceField = document.querySelector('input[name="budget_source"]');
        if (budgetSourceField) data.budget_source = budgetSourceField.value || '';

        const estimatedBudgetField = document.querySelector('input[name="estimated_budget"]');
        if (estimatedBudgetField) data.estimated_budget = estimatedBudgetField.value || '';

        // Person in charge
        const inchargeNameField = document.querySelector('input[name="incharge_name"]');
        if (inchargeNameField) data.incharge_name = inchargeNameField.value || '';

        const inchargeDesignationField = document.querySelector('input[name="incharge_designation"]');
        if (inchargeDesignationField) data.incharge_designation = inchargeDesignationField.value || '';

        const inchargeContactField = document.querySelector('input[name="incharge_contact"]');
        if (inchargeContactField) data.incharge_contact = inchargeContactField.value || '';

        const inchargeEmailField = document.querySelector('input[name="incharge_email"]');
        if (inchargeEmailField) data.incharge_email = inchargeEmailField.value || '';

        // Remarks (first textarea found)
        const remarksField = document.querySelector('textarea[name="remarks"]');
        if (remarksField) data.remarks = remarksField.value || '';

        // Technical Requirements (BMO Support)
        const venueField = document.querySelector('input[name="venue"]');
        if (venueField) data.venue = venueField.value || '';

        const wlMicField = document.getElementById('wl_mic');
        if (wlMicField) data.wl_mic = wlMicField.value || '0';

        const wiredMicField = document.getElementById('wired_mic');
        if (wiredMicField) data.wired_mic = wiredMicField.value || '0';

        const micStandsField = document.getElementById('mic_stands');
        if (micStandsField) data.mic_stands = micStandsField.value || '0';

        const lightsField = document.getElementById('lights');
        if (lightsField) data.lights = lightsField.value || '0';

        const othersTechField = document.querySelector('input[name="others_tech"]');
        if (othersTechField) data.others_tech = othersTechField.value || '';

        // Property Requirements (LMO Support)
        const longTableField = document.getElementById('long_table');
        if (longTableField) data.long_table = longTableField.value || '0';

        const teachersTablesField = document.getElementById('teachers_tables');
        if (teachersTablesField) data.teachers_tables = teachersTablesField.value || '0';

        const platformsField = document.getElementById('platforms');
        if (platformsField) data.platforms = platformsField.value || '0';

        const chairsField = document.getElementById('chairs');
        if (chairsField) data.chairs = chairsField.value || '0';

        const trashbinsField = document.querySelector('input[name="trashbins"]');
        if (trashbinsField) data.trashbins = trashbinsField.value || '0';

        const othersReqField = document.querySelector('input[name="others_req"]');
        if (othersReqField) data.others_req = othersReqField.value || '';

        // ITSS Support
        const multimediaField = document.querySelector('input[name="multimedia"]');
        if (multimediaField) data.multimedia = multimediaField.value || '';

        const othersSupportField = document.querySelector('input[name="others_support"]');
        if (othersSupportField) data.others_support = othersSupportField.value || '';

        // Administrative Support
        const guardsField = document.getElementById('guards');
        if (guardsField) data.guards = guardsField.value || '0';

        const parkingField = document.getElementById('parking');
        if (parkingField) data.parking = parkingField.value || '0';

        const transportationField = document.querySelector('input[name="transportation"]');
        if (transportationField) data.transportation = transportationField.value || '';

        const postingField = document.querySelector('input[name="posting"]');
        if (postingField) data.posting = postingField.value || '';

        // FMO Charges
        const janitoringField = document.getElementById('janitoring');
        if (janitoringField) data.janitoring = janitoringField.value || '0';

        const houselightsField = document.getElementById('houselights');
        if (houselightsField) data.houselights = houselightsField.value || '0';

        const technicalField = document.getElementById('technical');
        if (technicalField) data.technical = technicalField.value || '0';

        const waterField = document.getElementById('water');
        if (waterField) data.water = waterField.value || '0';

        const staffOtField = document.getElementById('staff_ot');
        if (staffOtField) data.staff_ot = staffOtField.value || '0';

        const othersApplicableField = document.getElementById('others_applicable');
        if (othersApplicableField) data.others_applicable = othersApplicableField.value || '0';

        const totalField = document.getElementById('total');
        if (totalField) data.total = totalField.value || '0';

        // Handle checkboxes for activity type
        const activityTypeChecked = document.querySelector('input[name="activity-type"]:checked');
        if (activityTypeChecked) {
          data.activity_type = activityTypeChecked.value;
        } else {
          data.activity_type = ''; // Ensure it's always set
        }

        console.log('Collected COMPLETE form data (including empty fields):', data);
        console.log('Total fields collected:', Object.keys(data).length);
        return data;
      }

      // Basic form validation
      function validateForm(data) {
        const requiredFields = {
          'organization_name': 'Organization/Office/College Name',
          'title': 'Title of Activity/Program',
          'nature': 'Nature of Activity',
          'location': 'Venue/Location',
          'incharge_name': 'Person in Charge Name',
          'incharge_email': 'Person in Charge Email'
        };

        console.log('Validating form data:', data);

        // Check required fields
        for (let [field, label] of Object.entries(requiredFields)) {
          if (!data[field] || data[field].toString().trim() === '') {
            alert(`Please fill in the "${label}" field.`);
            console.log(`Validation failed: ${field} is empty`);
            return false;
          }
        }

        // Check activity type
        if (!data.activity_type || data.activity_type.trim() === '') {
          alert('Please select an activity type.');
          console.log('Validation failed: activity_type is empty');
          return false;
        }

        // Validate email format
        const emailRegex = /^[^\s@]+@[^\s@]+\.[^\s@]+$/;
        if (!emailRegex.test(data.incharge_email)) {
          alert('Please enter a valid email address for the person in charge.');
          console.log('Validation failed: invalid email format');
          return false;
        }

        // Validate time fields (if both are provided)
        if (data.start_time && data.end_time) {
          const startTime = data.start_time;
          const endTime = data.end_time;

          // Simple time comparison (assumes same day)
          if (startTime >= endTime) {
            const confirmMultiDay = confirm(
              'The end time appears to be before the start time.\n\n' +
              'Is this a multi-day event?\n\n' +
              'Click "OK" if this is a multi-day event, or "Cancel" to fix the times.'
            );

            if (!confirmMultiDay) {
              console.log('Validation failed: user chose to fix time values');
              return false;
            } else {
              console.log('User confirmed multi-day event');
            }
          }
        }

        console.log('Form validation passed');
        return true;
      }

      // Download preview PDF
      function downloadPreviewPDF() {
        if (previewPdfUrl) {
          const link = document.createElement('a');
          link.href = previewPdfUrl;
          link.download = `SARF-Preview-${Date.now()}.pdf`;
          document.body.appendChild(link);
          link.click();
          document.body.removeChild(link);
        }
      }

      // Open PDF in new tab
      function openPDFNewTab() {
        if (previewPdfUrl) {
          window.open(previewPdfUrl, '_blank');
        }
      }

      // Close preview modal
      function closePreviewModal() {
        document.getElementById('previewModal').style.display = 'none';
        currentFormData = null;
        previewPdfUrl = null;
      }

      // Close success modal
      function closeSuccessModal() {
        document.getElementById('successModal').style.display = 'none';
      }

      // View my forms
      function viewMyForms() {
        window.location.href = '/user/my-sarf-forms';
      }

      // Make functions global
      window.submitSARFForm = submitSARFForm;
      window.finalSubmit = finalSubmit;
      window.downloadPreviewPDF = downloadPreviewPDF;
      window.closePreviewModal = closePreviewModal;
      window.closeSuccessModal = closeSuccessModal;
      window.viewMyForms = viewMyForms;
      window.zoomIn = zoomIn;
      window.zoomOut = zoomOut;

      // Initialize navbar and check authentication
      document.addEventListener('DOMContentLoaded', function() {
        const token = localStorage.getItem('token');
        if (!token) {
          window.location.href = '/login';
          return;
        }

        // Verify user role and initialize navbar
        fetch('/api/auth/verify', {
          headers: {
            'Authorization': `Bearer ${token}`
          }
        })
        .then(response => response.json())
        .then(data => {
          if (!data.user) {
            window.location.href = '/login';
            return;
          }

          // Allow admin, student, and external users to access this page
          if (data.user.role === 'admin') {
            initializeNavbar('user', 'reservation', 'student'); // Show as student for admin
          } else if (data.user.role === 'student' || data.user.role === 'external') {
            initializeNavbar('user', 'reservation', data.user.role);
          } else {
            window.location.href = '/login';
          }
        })
        .catch(error => {
          window.location.href = '/login';
        });
      });
    </script>
    <script src="/utils/navbar.js"></script>
    <footer class="footer">
      © 2025 University of the Cordilleras. All Rights Reserved.
    </footer>
  </body>
</html>
